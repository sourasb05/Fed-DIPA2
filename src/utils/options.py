import argparse


def args_parser():
    parser = argparse.ArgumentParser()
    
    parser.add_argument("--algorithm", type=str, default="Fedmem",
                        choices=["FedAvg",
                                "Fedmem", 
                                "FedProx", 
                                "FedDC", 
                                "Siloed", 
                                "Clustered_FedDC", 
                                "dynamic_FedDcprivacy", 
                                "apriori_FedDcprivacy", 
                                "ClusteredFedRep"])
    parser.add_argument("--batch_size", type=int, default=64)
    parser.add_argument("--num_teams", type=int, default=2)
    parser.add_argument("--lamda_sim_sta", type=float, default=0.5, help="hyperparameter for similarity and stability in CFedDC and FedProx")
    parser.add_argument("--gamma", type=float, default=1.0)
    parser.add_argument("--lambda_1", type=float, default=0.5, 
                        help="Regularization term lambda_1")
    parser.add_argument("--lambda_2", type=float, default=0.5, 
                        help="Regularization term lambda_2")
    parser.add_argument("--cluster", type = str, default="dynamic", choices=["apriori_hsgd", "dynamic", "apriori"])
    parser.add_argument("--users_frac", type=float, default=1.0)
    
    parser.add_argument("--user_ids", type=list, default=[['71', '7', '189', '202', '208', '0', '160', '10', '105', '68', '139', '207', '57', 
                                                         '128', '133', '190', '149', '290', '117', '253', '67', '76', '145', '162', '49', '17', 
                                                         '279', '200', '194', '3', '51', '204', '21', '22', '94', '206', '79', '30', '129', '115', 
                                                         '225', '184', '281', '88', '58', '295', '161', '250', '50', '63', '176', '275', '52', 
                                                         '35', '109', '240', '219', '138', '291', '62', '224', '267', '98', '252', '178', '106', '146', 
                                                         '169', '80', '75', '60', '44', '180', '116', '210', '144', '203', '37', '229', '212', '196', 
                                                         '33', '259', '187', '235', '300', '99', '181', '273', '172', '173', '218', '110', '248', '143', '228', 
                                                         '107', '92', '270', '175', '19', '286', '89', '277', '155', '55', '97', '93', '74', '182', '205', '157', 
                                                         '234', '39', '124', '28', '40', '73', '217', '126', '122', '8', '16', '54', '4', '14', '215', '121', '241', 
                                                         '245', '112', '61', '233', '256', '83', '168', '118', '64', '20', '177', '268', '147', '274', '158',
                                                         '195', '287', '77', '265', '211', '53', '81', '86', '134', '123', '154', '127', '216', '188', '56', '137', 
                                                         '103', '41', '2', '232', '26', '18', '1', '131', '288', '239', '31', '223', '231', '43', '263', '151', 
                                                         '140', '132', '159', '119', '91', '130', '6', '101', '255', '237', '25', '152', '87', 
                                                         '32', '227', '243', '111', '294', '42', '257', '183', '27', '90', '299', '214', '222', '298', '284',
                                                         '66', '251', '125', '269', '164', '271', '45', '198', '84', '246', '29', '150', '238', '293', '264', '156',
                                                         '12', '272', '70', '266', '260', '249', '199', '142', '258', '48', '69', '114', '15', '85', '283', 
                                                         '254', '135', '59', '197', '171', '297', '247', '120', '292', '179', '191', '113', '100', '95', '65', '46', 
                                                         '230', '136', '192', '236', '34', '186', '170', '36', '102', '276', '24', '221', '23', '11', '167', 
                                                         '153', '193', '13', '104', '201', '185', '261', '148', '9', '163', '78', '96', '209', '47'],
                                                        ['329', '325', '504', '584', '323', '369', '470', '597', '587', '524', '488', '482', '503', 
                                                         '408', '406', '544', '515', '432', '491', '327', '324', '590', '366', '307', '346', '486', '435', 
                                                         '446', '413', '500', '391', '433', '538', '460', '326', '492', '478', '551', '393', 
                                                         '573', '342', '417', '469', '351', '461', '502', '392', '512', '511', '497', '537', '335', '588', 
                                                         '526', '563', '394', '494', '558', '472', '523', '554', '395', '349', '310', '400', '570', '313', 
                                                         '361', '427', '371', '303', '519', '383', '431', '315', '308', '378', '385', '443', '539', '549', '479', 
                                                         '490', '328', '455', '487', '465', '334', '550', '579', '396', '305', '568', '501', '447', '569', 
                                                         '473', '380', '330', '561', '436', '403', '354', '388', '372', '418', '320', '529', '532', '459', '596', 
                                                         '404', '440', '517', '449', '438', '430', '441', '522', '332', '542', '581', '448', '386', 
                                                         '589', '412', '364', '437', '347', '466', '574', '471', '575', '489', '390', '445', '401', '339', 
                                                         '304', '426', '370', '540', '398', '531', '387', '547', '506', '483', '484', '505', '423', 
                                                         '508', '428', '381', '481', '578', '536', '514', '527', '451', '555', '462', '316', 
                                                         '485', '376', '595', '384', '562', '405', '407', '513', '582', '410', '356', '318', 
                                                         '530', '434', '545', '424', '336', '535', '420', '586', '416', '358', '463', 
                                                         '567', '340', '439', '507', '591', '453', '409', '312', '560', '422', '577', '516', '580', '368', 
                                                         '333', '309', '553', '415', '322', '357', '375', '521', '572', '528', '302', '362', '510', '477', 
                                                         '520', '355', '399', '411', '317', '456', '352', '389', '541', '402', '350', '583', '452', '444', 
                                                         '321', '419', '337', '474', '467', '359', '499', '546', '301', '367', '421', '379', '314', 
                                                         '556', '495', '496', '480'],
                                                         ['71', '7', '189', '202', '208', '0', '160', '10', '105', '68', '321', '419', '337', '474', '467', '359', '499', '546', '301', '367', '421', '379', '314', 
                                                         '556', '495', '496', '480', '140', '132', '159', '119', '91', '130', '6', '101', '255', '237', '25', '152', '87', 
                                                         '32', '227', '243', '111', '294', '42', '257', '183', '27', '90', '299', '214', '222', '298', '284',
                                                         '66', '251', '125', '269', '164', '271', '45', '198', '84', '246', '29', '150', '238', '293', '264', '156',
                                                         '12', '272', '70', '266', '260', '249', '199', '142', '258', '48', '69', '114', '15', '85', '283', 
                                                         ],
                                                         ['71', '7', '189', '202', '208', '0', '160', '10', '105', '68', '139', '207', '57', 
                                                         '128', '133', '190', '149', '290', '117', '253', '67', '76', '145', '162', '49', '17', 
                                                         '279', '200', '194', '3', '51', '204', '21', '22', '94', '206', '79', '30', '129', '115', 
                                                         '225', '184', '281', '88', '58', '295', '161', '250', '50', '63', '176', '275', '52', 
                                                         '35', '109', '240', '219', '138', '291', '62', '224', '267', '98', '252', '178', '106', '146', 
                                                         '169', '80', '75', '60', '44', '180', '116', '210', '144', '203', '37', '229', '212', '196', 
                                                         '33', '259', '187', '235', '300', '99', '181', '273', '172', '173', '218', '110', '248', '143', '228', 
                                                         '107', '92', '270', '175', '19', '286', '89', '277', '155', '55', '97', '93', '74', '182', '205', '157', 
                                                         '234', '39', '124', '28', '40', '73', '217', '126', '122', '8', '16', '54', '4', '14', '215', '121', '241', 
                                                         '245', '112', '61', '233', '256', '83', '168', '118', '64', '20', '177', '268', '147', '274', '158',
                                                         '195', '287', '77', '265', '211', '53', '81', '86', '134', '123', '154', '127', '216', '188', '56', '137', 
                                                         '103', '41', '2', '232', '26', '18', '1', '131', '288', '239', '31', '223', '231', '43', '263', '151', 
                                                         '140', '132', '159', '119', '91', '130', '6', '101', '255', '237', '25', '152', '87', 
                                                         '32', '227', '243', '111', '294', '42', '257', '183', '27', '90', '299', '214', '222', '298', '284',
                                                         '66', '251', '125', '269', '164', '271', '45', '198', '84', '246', '29', '150', '238', '293', '264', '156',
                                                         '12', '272', '70', '266', '260', '249', '199', '142', '258', '48', '69', '114', '15', '85', '283', 
                                                         '254', '135', '59', '197', '171', '297', '247', '120', '292', '179', '191', '113', '100', '95', '65', '46', 
                                                         '230', '136', '192', '236', '34', '186', '170', '36', '102', '276', '24', '221', '23', '11', '167', 
                                                         '153', '193', '13', '104', '201', '185', '261', '148', '9', '163', '78', '96', '209', '47','329', 
                                                         '325', '504', '584', '323', '369', '470', '597', '587', '524', '488', '482', '503', 
                                                         '408', '406', '544', '515', '432', '491', '327', '324', '590', '366', '307', '346', '486', '435', 
                                                         '446', '413', '500', '391', '433', '538', '460', '326', '492', '478', '551', '393', 
                                                         '573', '342', '417', '469', '351', '461', '502', '392', '512', '511', '497', '537', '335', '588', 
                                                         '526', '563', '394', '494', '558', '472', '523', '554', '395', '349', '310', '400', '570', '313', 
                                                         '361', '427', '371', '303', '519', '383', '431', '315', '308', '378', '385', '443', '539', '549', '479', 
                                                         '490', '328', '455', '487', '465', '334', '550', '579', '396', '305', '568', '501', '447', '569',
                                                         '473', '380', '330', '561', '436', '403', '354', '388', '372', '418', '320', '529', '532', '459', '596', 
                                                         '404', '440', '517', '449', '438', '430', '441', '522', '332', '542', '581', '448', '386', 
                                                         '589', '412', '364', '437', '347', '466', '574', '471', '575', '489', '390', '445', '401', '339', 
                                                         '304', '426', '370', '540', '398', '531', '387', '547', '506', '483', '484', '505', '423', 
                                                         '508', '428', '381', '481', '578', '536', '514', '527', '451', '555', '462', '316',  
                                                         '485', '376', '595', '384', '562', '405', '407', '513', '582', '410', '356', '318', 
                                                         '530', '434', '545', '424', '336', '535', '420', '586', '416', '358', '463', 
                                                         '567', '340', '439', '507', '591', '453', '409', '312', '560', '422', '577', '516', '580', '368', 
                                                         '333', '309', '553', '415', '322', '357', '375', '521', '572', '528', '302', '362', '510', '477', 
                                                         '520', '355', '399', '411', '317', '456', '352', '389', '541', '402', '350', '583', '452', '444', 
                                                         '321', '419', '337', '474', '467', '359', '499', '546', '301', '367', '421', '379', '314', 
                                                         '556', '495', '496', '480'],
                                                         [['71', '7', '189', '202', '208', '0', '160', '10', '105', '68'],
                                                          ['329', '325', '504', '584', '323', '369', '470', '597', '587', '524', '488', '482', ]],
                                                          #ResourceFul
                                                         ['101','438','123','185','66','96','32','364','194','30','275','215','64','111','28','41','42','170','340','117','51','107','25','198','84','171','163','304','419','57','265','24','68','115','58','267','241','256','77','81','232','237','125','494','202','10','273','264','189','75','112','260','65','230','186','167','507','580','160','190','145','279','35','37','99','19','39','217','158','263','307','461','512','554','465','567','453','200','300','155','124','31','214','85','369','491','473','449','574','481','0','3','88','98','146','97','147','1','223','43','227','90','12','114','283','36','446','492','455','505','527','577','399','480'],
                                                         #ResourceLess
                                                         ['71','7','208','105','139','207','128','133','149','290','253','67','76','49','17','204','21','22','94','206','79','129','225','184','281','295','161','250','50','63','176','52','109','240','219','138','291','62','224','252','178','106','169','80','60','44','180','210','144','203','229','212','196','33','259','187','235','181','172','173','218','110','248','143','228','92','270','175','286','89','55','93','182','205','157','234','73','126','122','8','16','54','4','14','121','245','61','233','83','168','118','20','177','274','195','287','211','53','86','134','154','127','216','188','137','103','2','26','18','131','239','231','151','140','132','159','119','91','130','6','255','87','243','294','257','183','27','299','222','298','284','251','269','164','271','45','246','29','150','293','156','272','70','266','249','199','142','258','69','15','254','135','59','197','297','247','120','292','179','191','113','100','95','46','136','192','236','34','102','276','221','23','11','153','193','13','104','201','261','9','47','325','504','323','470','597','587','524','488','482','503','408','544','515','327','324','346','486','435','413','500','391','433','538','460','326','478','551','393','573','469','351','511','537','335','588','526','394','523','349','310','400','570','361','427','371','303','431','378','385','549','490','328','487','550','396','305','568','447','569','380','561','436','354','388','418','532','459','596','440','430','522','332','542','448','386','412','347','466','471','575','489','390','445','401','339','370','540','398','531','423','508','428','578','536','514','555','462','316','485','376','595','384','562','405','513','582','530','434','545','336','535','586','358','463','591','409','312','516','368','309','553','322','357','521','572','528','302','362','510','477','520','411','389','350','452','444','321','337','474','467','499','546','301','367','421','495','496']
                                                         ]
                                                         ) 
    parser.add_argument("--country", type=str, default="both", choices=["japan", "uk", "both", "both_small", "none"])
    parser.add_argument("--user_filter", type=str, default="resourceful", choices=["resourceful", "resourceless", "none"])
    
    parser.add_argument("--alpha", type=float, default=0.05, 
                        help="learning rate for local models in fedmem")
    parser.add_argument("--eta", type=float, default=0.05, 
                        help="personalization parameter for Fedmem")
    parser.add_argument("--kappa", type=float, default=1.0, 
                        help="regularizer for resourceful and resourceful clients")
    parser.add_argument("--delta", type=float, default=1.0, 
                        help="regularizer for resourceless clients")
    
    
    parser.add_argument("--num_global_iters", type=int, default=3)
    parser.add_argument("--local_iters", type=int, default=2)
    parser.add_argument("--optimizer", type=str, default="SGD")
    
    
    parser.add_argument("--times", type=int, default=1, 
                        help="running time")
    parser.add_argument("--exp_start", type=int, default=0,
                        help="experiment start no")
    parser.add_argument("--gpu", type=int, default=0,
                        help="Which GPU to run the experiments, -1 mean CPU, 0,1,2 for GPU")
    
    parser.add_argument("--p", type=float, default=1.0, 
                        help="selected fraction of users available per global round")

    parser.add_argument("--fixed_user_id", type=int, default=16)
    parser.add_argument("--fix_client_every_GR", type=int, default=0, choices=[0,1])

    parser.add_argument("--wandb", action='store_true')
    parser.add_argument("--test", action='store_true')

    parser.add_argument("--exp_name", type=str, default="normal")

    parser.add_argument("--model_name", type=str, default="openai_ViT-L/14@336px", choices=["openai_ViT-L/14@336px", "resnet50"])

    args = parser.parse_args()

    return args
